<% title = 'User Watch History' %>

<div class="container">
  <div class="row justify-content-start">
    <div class="col-sm-4">
      <a href="/users" class="btn btn-secondary btn-lg mt-3">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-arrow-bar-left"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M12.5 15a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5M10 8a.5.5 0 0 1-.5.5H3.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L3.707 7.5H9.5a.5.5 0 0 1 .5.5"
          />
        </svg>
      </a>
    </div>
    <h3 class="col-sm-8 text-center mb-4">
      Watch History for <%= user.name %>
    </h3>
  </div>

  <div class="row justify-content-center">
    <div class="col-12 col-md-10">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Movie Name</th>
              <th>Watched On</th>
            </tr>
          </thead>
          <tbody>
            <% if (user.watchHistory && user.watchHistory.length > 0) { %> <%
            user.watchHistory.forEach(history => { %>
            <tr>
              <td>
                <%= history.movieId ? history.movieId.name : 'Unknown Movie' %>
              </td>
              <td><%= new Date(history.watchedOn).toLocaleString() %></td>
            </tr>
            <% }) %> <% } else { %>
            <tr>
              <td colspan="2" class="text-center">
                No watch history available
              </td>
            </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<style>
  .btn-no-border {
    border: none;
    background-color: transparent;
    color: inherit;
  }

  .btn-no-border:hover {
    background-color: transparent;
    text-decoration: none;
  }
</style>
